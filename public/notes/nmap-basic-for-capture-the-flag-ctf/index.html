<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Nmap Basics for Capture The Flag (CTF) |
Agus Fahmi Aji Pramana's Blogging Site
</title><meta name=keywords content="nmap,nse,wireshark,enumeration,reconnaissance"><meta name=description content="
    Understand different options used in Nmap to scan targets"><meta name=author content="Agus Fahmi Aji Pramana"><link rel=canonical href=http://localhost:1313/notes/nmap-basic-for-capture-the-flag-ctf/><link crossorigin=anonymous href=/assets/css/stylesheet.606be4c20b063263aae99830f89a0f4bbedcc98a7b8fea0b216f60439a69a571.css integrity="sha256-YGvkwgsGMmOq6Zgw+JoPS77cyYp7j+oLIW9gQ5pppXE=" rel="preload stylesheet" as=style><link crossorigin=anonymous referrerpolicy=no-referrer rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA=="><link rel=icon href=http://localhost:1313/favicon.ico type=image/x-icon><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon-32x32.png><link rel=manifest href=/site.webmanifest><link rel=icon type=image/png sizes=192x192 href=http://localhost:1313/img/android-chrome-192x192.png><link rel=icon type=image/png sizes=512x512 href=http://localhost:1313/img/android-chrome-512x512.png><link rel=apple-touch-icon href=http://localhost:1313/img/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/safari-pinned-tab.svg color=#2e2e33><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33
  "><link rel=alternate hreflang=en href=http://localhost:1313/notes/nmap-basic-for-capture-the-flag-ctf/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Nmap Basics for Capture The Flag (CTF)"><meta property="og:description" content="Understand different options used in Nmap to scan targets"><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/notes/nmap-basic-for-capture-the-flag-ctf/"><meta property="og:image" content="http://localhost:1313/logo.svg"><meta property="article:section" content="notes"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/logo.svg"><meta name=twitter:title content="Nmap Basics for Capture The Flag (CTF)"><meta name=twitter:description content="Understand different options used in Nmap to scan targets"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Personal Notes, Learning, Self-Preparation","item":"http://localhost:1313/notes/"},{"@type":"ListItem","position":2,"name":"Nmap Basics for Capture The Flag (CTF)","item":"http://localhost:1313/notes/nmap-basic-for-capture-the-flag-ctf/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Nmap Basics for Capture The Flag (CTF)","name":"Nmap Basics for Capture The Flag (CTF)","description":"Understand different options used in Nmap to scan targets","keywords":["nmap","nse","wireshark","enumeration","reconnaissance"],"articleBody":"Intro nmap is Network Mapper used for network discovery and security auditing. Nmap can be used for enumeration to identify open ports and services. Enumeration in Cybersecurity is information gathering technique.\nSome of the scripts in this category are considered intrusive and should not be run against a target network without permission.\n# Active host, network discovery sudo nmap -sn 10.10.0.0/24 # Scan all ports, takes longer. sudo nmap -p- # Enable version detection, name and description of identified services. sudo nmap -sV # Performs a script scan using the default set of scripts sudo nmap -sC # Aggressive scan. nmap -A # Aggressive, OS detection, Time Template Aggressive, Scan for vulnerability. nmap -A -O -T4 --script=vuln # Version, perform script, 5000 packets per second, all ports nmap -sV -sC -T4 –min-rate 5000 -p- RFC 9293 states that: “If the connection is CLOSED or doesn’t exists, then a RST is sent in response.”\nping sweep For black box penetration testing, “ping sweep” become very handy to map network structure with active IP address of hosts. Nmap provides -sn switch followed by IP range or CIDR notation to perform it.\nnmap -sn 10.0.0.1-254 or nmap -sn 10.10.0.0/24 Nmap Options Options Description -sS TCP SYN scan -sT TCP connect scan -sU UDP scans -sN; -sF; -sX TCP NULL, FIN, and Xmas scans, used for firewall evasion. Microsoft Windows/Cisco devices respond with a RST to any malformed TCP packet -sC Performs a script scan using the default set of scripts. It is equivalent to –script=default. -sV Enables version detection, which will detect what versions are running on what port. -O; –osscan-guess; –fuzzy Enable OS detection, guess near-match possibilities -A Aggressive Scan. Presently this enables OS detection (-O), version scanning (-sV), script scanning (-sC) and traceroute (–traceroute) -p- This flag scans for all TCP ports ranging from 0-65535 -p Scan specified ports –min-rate This is used to specify the minimum number of packets Nmap should send per second; it speeds up the scan as the number goes higher Timing Templates T0 T1 T2 T3 T4 T5 Paranoid Sneaky Polite Normal Aggressive Insane Understanding Network Traffic Changing the TCP connection options in nmap or using browser changes the type of network traffic in Wireshark. Differentiating all network scan traffic:\nBrowser: The network traffic captured shows full TCP handshake (SYN, SYN-ACK, ACK) for each new TCP connection. This is because the browser is establishing a full connection to retrieve the requested web page. Nmap Scan with -sS (TCP SYN Scan): The network traffic sent is (SYN, SYN-ACK). If nmap receives SYN-ACK then it indicates the port is open. There is no complete handshake with an ACK packet instead Nmap immediately sends an RST packet to close the connection referred to as (a half-open scan). This makes the scan faster and less likely to be logged by the target system. Nmap Scan with -sT (TCP Connect Scan): The network traffic sent is a full TCP connection (SYN, SYN-ACK, ACK) with each target port. This type of scan is more likely to be logged by the target system because it establishes a full connection Understanding NSE The Nmap Scripting Engine (NSE) is a powerful reconnaissance tool used for vulnerabilities scan, automating exploits.\nSome categories include (Reference: TryHackMe):\ncategory description safe Won’t affect the target intrusive Not safe: likely to affect the target vuln Scan for vulnerabilities exploit Attempt to exploit a vulnerability auth Attempt to bypass authentication for running services (e.g. Log into an FTP server anonymously) brute Attempt to bruteforce credentials for running services discovery Attempt to query running services for further information about the network (e.g. query an SNMP server). References https://nmap.org/book/performance-timing-templates.html https://nmap.org/nsedoc/categories/vuln.html https://nmap.org/book/nse-usage.html https://mohomedarfath.medium.com/nmap-tryhackme-room-level-1-level-7-41ba9ff689ae ","wordCount":"617","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","author":{"@type":"Person","name":"Agus Fahmi Aji Pramana"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/notes/nmap-basic-for-capture-the-flag-ctf/"},"publisher":{"@type":"Organization","name":"Agus Fahmi Aji Pramana's Blogging Site","logo":{"@type":"ImageObject","url":"http://localhost:1313/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Agus Fahmi Aji Pramana (Alt + H)">Agus Fahmi Aji Pramana</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=http://localhost:1313/about-me title="About Me"><span>About Me</span></a></li><li><a href=http://localhost:1313/blogs title=Blogs><span>Blogs</span></a></li><li><a href=http://localhost:1313/projects title=Projects><span>Projects</span></a></li><li><a href=http://localhost:1313/slides title=Slides><span>Slides</span></a></li><li><a href=http://localhost:1313/honors title=Honors><span>Honors</span></a></li><li><a href=http://localhost:1313/search title="Search (Alt + /)" accesskey=/><i class="fa fa-search"></i></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/notes/>Personal Notes, Learning, Self-Preparation</a></div><h1 class="post-title entry-hint-parent">Nmap Basics for Capture The Flag (CTF)</h1><div class=post-description>Understand different options used in Nmap to scan targets</div><div class=post-meta>3 min&nbsp;·&nbsp;617 words&nbsp;·&nbsp;Agus Fahmi Aji Pramana</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Agenda</span></summary><div class=inner><ul><li><a href=#intro aria-label=Intro>Intro</a><ul><li><a href=#ping-sweep aria-label="ping sweep">ping sweep</a></li><li><a href=#nmap-options aria-label="Nmap Options">Nmap Options</a></li><li><a href=#timing-templates aria-label="Timing Templates">Timing Templates</a></li></ul></li><li><a href=#understanding-network-traffic aria-label="Understanding Network Traffic">Understanding Network Traffic</a></li><li><a href=#understanding-nse aria-label="Understanding NSE">Understanding NSE</a></li><li><a href=#references aria-label=References>References</a></li></ul></div></details></div><div class=post-content><h2 id=intro>Intro<a hidden class=anchor aria-hidden=true href=#intro>#</a></h2><p><code>nmap</code> is Network Mapper used for network discovery and security auditing. Nmap can be used for enumeration to identify open ports and services. <strong>Enumeration</strong> in Cybersecurity is information gathering technique.</p><blockquote><p>Some of the scripts in this category are considered intrusive and should not be run against a target network without permission.</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Active host, network discovery</span>
</span></span><span class=line><span class=cl>sudo nmap -sn 10.10.0.0/24
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Scan all ports, takes longer.</span>
</span></span><span class=line><span class=cl>sudo nmap -p- &lt;target-ip-addr&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Enable version detection, name and description of identified services.</span>
</span></span><span class=line><span class=cl>sudo nmap -sV &lt;target-ip-addr&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Performs a script scan using the default set of scripts</span>
</span></span><span class=line><span class=cl>sudo nmap -sC &lt;target-ip-addr&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Aggressive scan.</span>
</span></span><span class=line><span class=cl>nmap -A &lt;target-ip-addr&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Aggressive, OS detection, Time Template Aggressive, Scan for vulnerability.</span>
</span></span><span class=line><span class=cl>nmap -A -O -T4 --script<span class=o>=</span>vuln &lt;target-ip-addr&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Version, perform script, 5000 packets per second, all ports</span>
</span></span><span class=line><span class=cl>nmap -sV -sC -T4 –min-rate <span class=m>5000</span> -p- &lt;target-ip-addr&gt;
</span></span></code></pre></div><blockquote><p>RFC 9293 states that: &ldquo;If the connection is CLOSED or doesn&rsquo;t exists, then a RST is sent in response.&rdquo;</p></blockquote><h3 id=ping-sweep>ping sweep<a hidden class=anchor aria-hidden=true href=#ping-sweep>#</a></h3><p>For black box penetration testing, &ldquo;ping sweep&rdquo; become very handy to map network structure with active IP address of hosts. Nmap provides <code>-sn</code> switch followed by IP range or CIDR notation to perform it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nmap -sn 10.0.0.1-254
</span></span><span class=line><span class=cl>or
</span></span><span class=line><span class=cl>nmap -sn 10.10.0.0/24
</span></span></code></pre></div><h3 id=nmap-options>Nmap Options<a hidden class=anchor aria-hidden=true href=#nmap-options>#</a></h3><table><thead><tr><th>Options</th><th>Description</th></tr></thead><tbody><tr><td>-sS</td><td>TCP SYN scan</td></tr><tr><td>-sT</td><td>TCP connect scan</td></tr><tr><td>-sU</td><td>UDP scans</td></tr><tr><td>-sN; -sF; -sX</td><td>TCP NULL, FIN, and Xmas scans, used for firewall evasion. Microsoft Windows/Cisco devices respond with a RST to any malformed TCP packet</td></tr><tr><td>-sC</td><td>Performs a script scan using the default set of scripts. It is equivalent to &ndash;script=default.</td></tr><tr><td>-sV</td><td>Enables version detection, which will detect what versions are running on what port.</td></tr><tr><td>-O; &ndash;osscan-guess; &ndash;fuzzy</td><td>Enable OS detection, guess near-match possibilities</td></tr><tr><td>-A</td><td>Aggressive Scan. Presently this enables OS detection (-O), version scanning (-sV), script scanning (-sC) and traceroute (&ndash;traceroute)</td></tr><tr><td>-p-</td><td>This flag scans for all TCP ports ranging from 0-65535</td></tr><tr><td>-p <port-ranges></td><td>Scan specified ports</td></tr><tr><td>&ndash;min-rate &lt;no. packet/sec></td><td>This is used to specify the minimum number of packets Nmap should send per second; it speeds up the scan as the number goes higher</td></tr></tbody></table><h3 id=timing-templates>Timing Templates<a hidden class=anchor aria-hidden=true href=#timing-templates>#</a></h3><table><thead><tr><th>T0</th><th>T1</th><th>T2</th><th>T3</th><th>T4</th><th>T5</th></tr></thead><tbody><tr><td>Paranoid</td><td>Sneaky</td><td>Polite</td><td>Normal</td><td>Aggressive</td><td>Insane</td></tr></tbody></table><h2 id=understanding-network-traffic>Understanding Network Traffic<a hidden class=anchor aria-hidden=true href=#understanding-network-traffic>#</a></h2><p>Changing the TCP connection options in nmap or using browser changes the type of network traffic in Wireshark. Differentiating all network scan traffic:</p><ul><li><strong>Browser</strong>:
The network traffic captured shows full TCP handshake (<code>SYN, SYN-ACK, ACK</code>) for each new TCP connection. This is because the browser is establishing a full connection to retrieve the requested web page.</li><li>Nmap Scan with <strong><code>-sS</code></strong> (TCP SYN Scan):
The network traffic sent is (<code>SYN, SYN-ACK</code>). If nmap receives SYN-ACK then it indicates the port is open. There is no complete handshake with an ACK packet instead Nmap immediately sends an <code>RST</code> packet to close the connection referred to as (a half-open scan). This makes the scan faster and less likely to be logged by the target system.</li><li>Nmap Scan with <strong><code>-sT</code></strong> (TCP Connect Scan):
The network traffic sent is a full TCP connection (<code>SYN, SYN-ACK, ACK</code>) with each target port. This type of scan is more likely to be logged by the target system because it establishes a full connection</li></ul><h2 id=understanding-nse>Understanding NSE<a hidden class=anchor aria-hidden=true href=#understanding-nse>#</a></h2><p>The Nmap Scripting Engine (NSE) is a powerful reconnaissance tool used for vulnerabilities scan, automating exploits.</p><p>Some categories include (Reference: <a href=https://tryhackme.com/room/furthernmap>TryHackMe</a>):</p><table><thead><tr><th>category</th><th>description</th></tr></thead><tbody><tr><td>safe</td><td>Won&rsquo;t affect the target</td></tr><tr><td>intrusive</td><td><strong>Not safe</strong>: likely to affect the target</td></tr><tr><td>vuln</td><td>Scan for vulnerabilities</td></tr><tr><td>exploit</td><td>Attempt to exploit a vulnerability</td></tr><tr><td>auth</td><td>Attempt to bypass authentication for running services (e.g. Log into an FTP server anonymously)</td></tr><tr><td>brute</td><td>Attempt to bruteforce credentials for running services</td></tr><tr><td>discovery</td><td>Attempt to query running services for further information about the network (e.g. query an SNMP server).</td></tr></tbody></table><h2 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h2><ul><li><a href=https://nmap.org/book/performance-timing-templates.html>https://nmap.org/book/performance-timing-templates.html</a></li><li><a href=https://nmap.org/nsedoc/categories/vuln.html>https://nmap.org/nsedoc/categories/vuln.html</a></li><li><a href=https://nmap.org/book/nse-usage.html>https://nmap.org/book/nse-usage.html</a></li><li><a href=https://mohomedarfath.medium.com/nmap-tryhackme-room-level-1-level-7-41ba9ff689ae>https://mohomedarfath.medium.com/nmap-tryhackme-room-level-1-level-7-41ba9ff689ae</a></li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/nmap/>Nmap</a></li><li><a href=http://localhost:1313/tags/nse/>Nse</a></li><li><a href=http://localhost:1313/tags/wireshark/>Wireshark</a></li><li><a href=http://localhost:1313/tags/enumeration/>Enumeration</a></li><li><a href=http://localhost:1313/tags/reconnaissance/>Reconnaissance</a></li></ul></footer></article></main><footer class=footer><span>&copy;
2025
<a href=http://localhost:1313/>Agus Fahmi Aji Pramana's Blogging Site</a></span>
| <span><a href=/terms-and-conditions>Terms and Conditions</a>
</span>|
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a>
&
      <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span><br></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})}),document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll(".project");e.forEach(function(e){e.addEventListener("click",function(t){t.target.closest(".small-icons")||window.open(e.getAttribute("data-project-link"),"_blank").focus()})})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>